(()=>{var s={806:(s,t,i)=>{Object.defineProperty(t,"t",{value:!0}),t.i=t.h=void 0,i(364);class h{k;o;constructor(){this.k=0,this.o=0}u(s){return this.k=255&s,this}l(s){return this.o=255&s,this}m(s){return this.o=255&s,this.k=s>>8&255,this}p(){return this.k}v(){return this.o}_(){return(this.k<<8)+this.o}}t.h=h,t.i=class{R;A;C;constructor(s){this.R=s,this.A=0,this.C=0}S(s){this.C+=s,-64&this.C&&(this.R.j(4,this.R.U(4)+(this.C>>6)),this.C&=63);const t=this.R.U(7);if(!(4&t))return;let i;switch(this.A+=s,3&t){case 0:i=12;break;case 1:i=18;break;case 2:i=16;break;default:i=14}const h=20-i;if(this.A>>h>0){const s=1<<h;do{this.R.j(5,this.R.U(5)+1),0==this.R.U(5)&&(this.R.j(15,4|this.R.U(15)),this.R.j(5,this.R.U(6))),this.A-=s}while(this.A>>h>0)}}};class e{static O=[1,3,2,2,1,1,2,1,5,2,2,2,1,1,2,1,0,3,2,2,1,1,2,1,3,2,2,2,1,1,2,1,2,3,2,2,1,1,2,1,2,2,2,2,1,1,2,1,2,3,2,2,3,3,3,1,2,2,2,2,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,2,2,2,2,2,0,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,3,3,4,3,4,2,4,2,4,3,0,3,6,2,4,2,3,3,0,3,4,2,4,2,4,3,0,3,0,2,4,3,3,2,0,0,4,2,4,4,1,4,0,0,0,2,4,3,3,2,1,0,4,2,4,3,2,4,1,0,0,2,4];static L=[2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2];B;M;D;P;H;pc;R;K;T;F;buttons;I(){return this.pc}N(){return this.H}W(){return this.B}X(){return this.M}Y(){return this.D}Z(){return this.P}constructor(s){this.R=s,this.B=new h,this.M=new h,this.D=new h,this.P=new h,this.B.m(432),this.M.m(19),this.D.m(216),this.P.m(333),this.pc=256,this.H=65534,this.K=0,this.T=!1,this.F=!1,this.buttons=0,s.j(0,207),s.j(2,126),s.j(5,0),s.j(6,0),s.j(7,0),s.write(65296,128),s.write(65297,191),s.write(65298,243),s.write(65300,191),s.write(65302,63),s.write(65303,0),s.write(65305,191),s.write(65306,127),s.write(65307,255),s.write(65308,159),s.write(65310,191),s.write(65312,255),s.write(65313,0),s.write(65314,0),s.write(65315,191),s.write(65316,119),s.write(65317,243),s.write(65318,241),s.j(64,145),s.j(65,0),s.j(66,0),s.j(67,0),s.j(68,0),s.j(69,0),s.j(71,252),s.j(72,255),s.j(73,255),s.j(74,0),s.j(75,0),s.j(80,1),s.write(65535,0)}static G(s){return(s&=255)>127?s-256:s}q=()=>this.R.read(this.pc++);J=()=>(new h).l(this.q()).u(this.q());V=()=>this.J()._();$=s=>this.B.l(this.B.v()|s);ss=s=>this.B.l(this.B.v()&~s);ts=(s,t)=>t?this.$(s):this.ss(s);hs=s=>!!(this.B.v()&s);es(s){this.R.write(--this.H,s.p()),this.H&=65535,this.R.write(--this.H,s.v()),this.H&=65535}rs(){const s=new h;return s.l(this.R.read(this.H++)),this.H&=65535,s.u(this.R.read(this.H++)),this.H&=65535,s}cs=(s,t,i)=>{const h=s+t+(i?1:0),e=(15&s)+(15&t)+(i?1:0);return this.ts(128,!(255&h)),this.ss(64),this.ts(32,e>15),this.ts(16,h>255),255&h};bs=(s,t)=>{const i=s+t,h=(4095&s)+(4095&t);return this.ss(64),this.ts(32,h>4095),this.ts(16,i>65535),65535&i};ns=(s,t,i)=>{const h=s-t-(i?1:0)&65535,e=(15&s)-(15&t)-(i?1:0)&65535;return this.ts(128,!(255&h)),this.$(64),this.ts(32,e>15),this.ts(16,h>255),255&h};ks(s){return this.ts(128,255==s),this.ss(64),this.ts(32,!(15&~s)),s+1}os(s){return this.ts(128,1==s),this.$(64),this.ts(32,!(15&s)),s-1}and(s){this.B.u(this.B.p()&s),this.ts(128,0==this.B.p()),this.ss(64),this.$(32),this.ss(16)}or(s){this.B.u(this.B.p()|s),this.ts(128,0==this.B.p()),this.ss(64),this.ss(32),this.ss(16)}xor(s){this.B.u(this.B.p()^s),this.ts(128,0==this.B.p()),this.ss(64),this.ss(32),this.ss(16)}us(s){return this.ts(128,0==s),this.ss(64),this.ss(32),this.ts(16,!!(128&s)),255&(s<<1|s>>7)}ls(s){return this.ts(128,0==s),this.ss(64),this.ss(32),this.ts(16,!!(1&s)),255&(s>>1|s<<7)}fs(s){const t=this.hs(16)?1:0;return this.ts(128,!((s<<1)+t&255)),this.ss(64),this.ss(32),this.ts(16,!!(128&s)),(s<<1)+t&255}ds(s){const t=this.hs(16)?128:0;return this.ts(128,(s>>1)+t==0),this.ss(64),this.ss(32),this.ts(16,!!(1&s)),(s>>1)+t}ws(s){return this.$(64),this.$(32),255^s}ps(s){return this.ts(128,!(s<<1&255)),this.ss(64),this.ss(32),this.ts(16,!!(128&s)),s<<1&255}vs(s){return this.ts(128,!(255&(s>>1|128&s))),this.ss(64),this.ss(32),this.ts(16,!!(1&s)),255&(s>>1|128&s)}gs(s){return this.ts(128,!(s>>1&255)),this.ss(64),this.ss(32),this.ts(16,!!(1&s)),s>>1&255}ys(s){return s=255&(s>>4|s<<4),this.ts(128,0==s),this.ss(64),this.ss(32),this.ss(16),s}_s=s=>this.pc=s;Rs=s=>this.pc+=e.G(s);As(){this.pc=this.rs()._()}xs(s){this.es((new h).m(this.pc)),this.pc=s}Cs(s,t){return t?(this._s(s),1):0}Ss(s,t){return t?(this.Rs(s),1):0}js(s,t){return t?(this.xs(s),3):0}Us(s){return s?(this.As(),3):0}Os(s){switch(s){case 0:return this.M.p();case 1:return this.M.v();case 2:return this.D.p();case 3:return this.D.v();case 4:return this.P.p();case 5:return this.P.v();case 6:return this.R.read(this.P._());case 7:return this.B.p()}return 255}Ls(s,t){switch(s){case 0:return void this.M.u(t);case 1:return void this.M.l(t);case 2:return void this.D.u(t);case 3:return void this.D.l(t);case 4:return void this.P.u(t);case 5:return void this.P.l(t);case 6:return void this.R.write(this.P._(),t);case 7:return void this.B.u(t)}}Bs(s){const t=s>>6,i=s>>3&7,h=7&s;let e=this.Os(h);switch(t){case 0:switch(i){case 0:e=this.us(e);break;case 1:e=this.ls(e);break;case 2:e=this.fs(e);break;case 3:e=this.ds(e);break;case 4:e=this.ps(e);break;case 5:e=this.vs(e);break;case 6:e=this.ys(e);break;case 7:e=this.gs(e)}this.Ls(h,e);break;case 1:this.ts(128,!(e&1<<i)),this.ss(64),this.$(32);break;case 2:e&=~(1<<i),this.Ls(h,e);break;case 3:e|=1<<i,this.Ls(h,e)}}Ms(s){this.buttons|=s}Ds(s){this.buttons&=~s}S(){let s=0;const t=255^this.buttons,i=this.R.U(0);32&i?this.R.j(0,240&i|t>>4&15):16&i?this.R.j(0,240&i|15&t):3==i&&this.R.j(0,255);const h=this.R.U(15),a=31&h&this.R.read(65535);if(0!=a&&(this.T&&(this.T=!1),1&this.K))for(let t=0;t<5;t++)if(a&1<<t){this.K&=-2,s+=2,this.xs(64+(t<<3)),this.R.j(15,h&~(1<<t));break}if(this.T)return++s,s;2&this.K&&(this.K|=1,this.K&=-3),this.pc;const r=this.q();this.F&&(this.F=!1,--this.pc);const c=203==r?this.q():0,b=this.hs(16);switch(r){case 0:case 16:break;case 1:this.M=this.J();break;case 17:this.D=this.J();break;case 33:this.P=this.J();break;case 49:this.H=this.J()._();break;case 2:this.R.write(this.M._(),this.B.p());break;case 18:this.R.write(this.D._(),this.B.p());break;case 34:this.R.write(this.P._(),this.B.p()),this.P.m(this.P._()+1);break;case 50:this.R.write(this.P._(),this.B.p()),this.P.m(this.P._()-1);break;case 3:this.M.m(this.M._()+1);break;case 19:this.D.m(this.D._()+1);break;case 35:this.P.m(this.P._()+1);break;case 51:++this.H,this.H&=65535;break;case 4:this.M.u(this.ks(this.M.p()));break;case 20:this.D.u(this.ks(this.D.p()));break;case 36:this.P.u(this.ks(this.P.p()));break;case 52:{const s=this.ks(this.R.read(this.P._()));this.R.write(this.P._(),s);break}case 5:this.M.u(this.os(this.M.p()));break;case 21:this.D.u(this.os(this.D.p()));break;case 37:this.P.u(this.os(this.P.p()));break;case 53:{const s=this.os(this.R.read(this.P._()));this.R.write(this.P._(),s);break}case 6:this.M.u(this.q());break;case 22:this.D.u(this.q());break;case 38:this.P.u(this.q());break;case 54:this.R.write(this.P._(),this.q());break;case 7:this.ss(128),this.ss(32),this.ss(64),this.ts(16,!!(128&this.B.p())),this.B.u(this.B.p()<<1|this.B.p()>>7);break;case 15:this.ss(128),this.ss(32),this.ss(64),this.ts(16,!!(1&this.B.p())),this.B.u(this.B.p()>>1|this.B.p()<<7);break;case 23:this.ss(128),this.ss(32),this.ss(64),this.ts(16,!!(128&this.B.p())),this.B.u(this.B.p()<<1|(b?1:0));break;case 31:this.ss(128),this.ss(32),this.ss(64),this.ts(16,!!(1&this.B.p())),this.B.u(this.B.p()>>1|(b?128:0));break;case 47:this.B.u(this.ws(this.B.p()));break;case 39:{let s=this.B.p();this.hs(64)?(this.hs(32)&&(s-=6,s&=255),this.hs(16)&&(s-=96)):(((15&s)>9||this.hs(32))&&(s+=6),(s>159||this.hs(16))&&(s+=96)),this.ts(128,!(255&s)),this.ss(32),256&s&&this.$(16),this.B.u(255&s);break}case 55:this.ss(64),this.ss(32),this.$(16);break;case 63:this.ss(64),this.ss(32),this.ts(16,!this.hs(16));break;case 8:{let s=this.V();this.R.write(s++,255&this.H),this.R.write(s++,(65280&this.H)>>8);break}case 232:{const s=this.H+e.G(this.q())&65535;this.ss(128),this.ss(64),this.ts(32,(15&s)<(15&this.H)),this.ts(16,(255&s)<(255&this.H)),this.H=s;break}case 248:{const s=this.H+e.G(this.q())&65535;this.ss(128),this.ss(64),this.ts(32,(15&s)<(15&this.H)),this.ts(16,(255&s)<(255&this.H)),this.P.m(s);break}case 9:this.P.m(this.bs(this.P._(),this.M._()));break;case 25:this.P.m(this.bs(this.P._(),this.D._()));break;case 41:this.P.m(this.bs(this.P._(),this.P._()));break;case 57:this.P.m(this.bs(this.P._(),this.H));break;case 249:this.H=this.P._();break;case 11:this.M.m(this.M._()-1);break;case 27:this.D.m(this.D._()-1);break;case 43:this.P.m(this.P._()-1);break;case 59:--this.H,this.H&=65535;break;case 10:this.B.u(this.R.read(this.M._()));break;case 26:this.B.u(this.R.read(this.D._()));break;case 42:this.B.u(this.R.read(this.P._())),this.P.m(this.P._()+1);break;case 58:this.B.u(this.R.read(this.P._())),this.P.m(this.P._()-1);break;case 12:this.M.l(this.ks(this.M.v()));break;case 28:this.D.l(this.ks(this.D.v()));break;case 44:this.P.l(this.ks(this.P.v()));break;case 60:this.B.u(this.ks(this.B.p()));break;case 13:this.M.l(this.os(this.M.v()));break;case 29:this.D.l(this.os(this.D.v()));break;case 45:this.P.l(this.os(this.P.v()));break;case 61:this.B.u(this.os(this.B.p()));break;case 14:this.M.l(this.q());break;case 30:this.D.l(this.q());break;case 46:this.P.l(this.q());break;case 62:this.B.u(this.q());break;case 64:this.M.u(this.M.p());break;case 65:this.M.u(this.M.v());break;case 66:this.M.u(this.D.p());break;case 67:this.M.u(this.D.v());break;case 68:this.M.u(this.P.p());break;case 69:this.M.u(this.P.v());break;case 70:this.M.u(this.R.read(this.P._()));break;case 71:this.M.u(this.B.p());break;case 72:this.M.l(this.M.p());break;case 73:this.M.l(this.M.v());break;case 74:this.M.l(this.D.p());break;case 75:this.M.l(this.D.v());break;case 76:this.M.l(this.P.p());break;case 77:this.M.l(this.P.v());break;case 78:this.M.l(this.R.read(this.P._()));break;case 79:this.M.l(this.B.p());break;case 80:this.D.u(this.M.p());break;case 81:this.D.u(this.M.v());break;case 82:this.D.u(this.D.p());break;case 83:this.D.u(this.D.v());break;case 84:this.D.u(this.P.p());break;case 85:this.D.u(this.P.v());break;case 86:this.D.u(this.R.read(this.P._()));break;case 87:this.D.u(this.B.p());break;case 88:this.D.l(this.M.p());break;case 89:this.D.l(this.M.v());break;case 90:this.D.l(this.D.p());break;case 91:this.D.l(this.D.v());break;case 92:this.D.l(this.P.p());break;case 93:this.D.l(this.P.v());break;case 94:this.D.l(this.R.read(this.P._()));break;case 95:this.D.l(this.B.p());break;case 96:this.P.u(this.M.p());break;case 97:this.P.u(this.M.v());break;case 98:this.P.u(this.D.p());break;case 99:this.P.u(this.D.v());break;case 100:this.P.u(this.P.p());break;case 101:this.P.u(this.P.v());break;case 102:this.P.u(this.R.read(this.P._()));break;case 103:this.P.u(this.B.p());break;case 104:this.P.l(this.M.p());break;case 105:this.P.l(this.M.v());break;case 106:this.P.l(this.D.p());break;case 107:this.P.l(this.D.v());break;case 108:this.P.l(this.P.p());break;case 109:this.P.l(this.P.v());break;case 110:this.P.l(this.R.read(this.P._()));break;case 111:this.P.l(this.B.p());break;case 112:this.R.write(this.P._(),this.M.p());break;case 113:this.R.write(this.P._(),this.M.v());break;case 114:this.R.write(this.P._(),this.D.p());break;case 115:this.R.write(this.P._(),this.D.v());break;case 116:this.R.write(this.P._(),this.P.p());break;case 117:this.R.write(this.P._(),this.P.v());break;case 118:this.T=!0,this.F=!(1&this.K);break;case 119:this.R.write(this.P._(),this.B.p());break;case 120:this.B.u(this.M.p());break;case 121:this.B.u(this.M.v());break;case 122:this.B.u(this.D.p());break;case 123:this.B.u(this.D.v());break;case 124:this.B.u(this.P.p());break;case 125:this.B.u(this.P.v());break;case 126:this.B.u(this.R.read(this.P._()));break;case 127:this.B.u(this.B.p());break;case 128:this.B.u(this.cs(this.B.p(),this.M.p(),!1));break;case 129:this.B.u(this.cs(this.B.p(),this.M.v(),!1));break;case 130:this.B.u(this.cs(this.B.p(),this.D.p(),!1));break;case 131:this.B.u(this.cs(this.B.p(),this.D.v(),!1));break;case 132:this.B.u(this.cs(this.B.p(),this.P.p(),!1));break;case 133:this.B.u(this.cs(this.B.p(),this.P.v(),!1));break;case 134:this.B.u(this.cs(this.B.p(),this.R.read(this.P._()),!1));break;case 135:this.B.u(this.cs(this.B.p(),this.B.p(),!1));break;case 198:this.B.u(this.cs(this.B.p(),this.q(),!1));break;case 136:this.B.u(this.cs(this.B.p(),this.M.p(),this.hs(16)));break;case 137:this.B.u(this.cs(this.B.p(),this.M.v(),this.hs(16)));break;case 138:this.B.u(this.cs(this.B.p(),this.D.p(),this.hs(16)));break;case 139:this.B.u(this.cs(this.B.p(),this.D.v(),this.hs(16)));break;case 140:this.B.u(this.cs(this.B.p(),this.P.p(),this.hs(16)));break;case 141:this.B.u(this.cs(this.B.p(),this.P.v(),this.hs(16)));break;case 142:this.B.u(this.cs(this.B.p(),this.R.read(this.P._()),this.hs(16)));break;case 143:this.B.u(this.cs(this.B.p(),this.B.p(),this.hs(16)));break;case 206:this.B.u(this.cs(this.B.p(),this.q(),this.hs(16)));break;case 144:this.B.u(this.ns(this.B.p(),this.M.p(),!1));break;case 145:this.B.u(this.ns(this.B.p(),this.M.v(),!1));break;case 146:this.B.u(this.ns(this.B.p(),this.D.p(),!1));break;case 147:this.B.u(this.ns(this.B.p(),this.D.v(),!1));break;case 148:this.B.u(this.ns(this.B.p(),this.P.p(),!1));break;case 149:this.B.u(this.ns(this.B.p(),this.P.v(),!1));break;case 150:this.B.u(this.ns(this.B.p(),this.R.read(this.P._()),!1));break;case 151:this.B.u(this.ns(this.B.p(),this.B.p(),!1));break;case 214:this.B.u(this.ns(this.B.p(),this.q(),!1));break;case 152:this.B.u(this.ns(this.B.p(),this.M.p(),this.hs(16)));break;case 153:this.B.u(this.ns(this.B.p(),this.M.v(),this.hs(16)));break;case 154:this.B.u(this.ns(this.B.p(),this.D.p(),this.hs(16)));break;case 155:this.B.u(this.ns(this.B.p(),this.D.v(),this.hs(16)));break;case 156:this.B.u(this.ns(this.B.p(),this.P.p(),this.hs(16)));break;case 157:this.B.u(this.ns(this.B.p(),this.P.v(),this.hs(16)));break;case 158:this.B.u(this.ns(this.B.p(),this.R.read(this.P._()),this.hs(16)));break;case 159:this.B.u(this.ns(this.B.p(),this.B.p(),this.hs(16)));break;case 222:this.B.u(this.ns(this.B.p(),this.q(),this.hs(16)));break;case 160:this.and(this.M.p());break;case 161:this.and(this.M.v());break;case 162:this.and(this.D.p());break;case 163:this.and(this.D.v());break;case 164:this.and(this.P.p());break;case 165:this.and(this.P.v());break;case 166:this.and(this.R.read(this.P._()));break;case 167:this.and(this.B.p());break;case 230:this.and(this.q());break;case 168:this.xor(this.M.p());break;case 169:this.xor(this.M.v());break;case 170:this.xor(this.D.p());break;case 171:this.xor(this.D.v());break;case 172:this.xor(this.P.p());break;case 173:this.xor(this.P.v());break;case 174:this.xor(this.R.read(this.P._()));break;case 175:this.xor(this.B.p());break;case 238:this.xor(this.q());break;case 176:this.or(this.M.p());break;case 177:this.or(this.M.v());break;case 178:this.or(this.D.p());break;case 179:this.or(this.D.v());break;case 180:this.or(this.P.p());break;case 181:this.or(this.P.v());break;case 182:this.or(this.R.read(this.P._()));break;case 183:this.or(this.B.p());break;case 246:this.or(this.q());break;case 184:this.ns(this.B.p(),this.M.p(),!1);break;case 185:this.ns(this.B.p(),this.M.v(),!1);break;case 186:this.ns(this.B.p(),this.D.p(),!1);break;case 187:this.ns(this.B.p(),this.D.v(),!1);break;case 188:this.ns(this.B.p(),this.P.p(),!1);break;case 189:this.ns(this.B.p(),this.P.v(),!1);break;case 190:this.ns(this.B.p(),this.R.read(this.P._()),!1);break;case 191:this.ns(this.B.p(),this.B.p(),!1);break;case 254:this.ns(this.B.p(),this.q(),!1);break;case 193:this.M=this.rs();break;case 209:this.D=this.rs();break;case 225:this.P=this.rs();break;case 241:this.B=this.rs(),this.B.l(240&this.B.v());break;case 197:this.es(this.M);break;case 213:this.es(this.D);break;case 229:this.es(this.P);break;case 245:this.es(this.B);break;case 234:this.R.write(this.V(),this.B.p());break;case 250:this.B.u(this.R.read(this.V()));break;case 233:this.pc=this.P._();break;case 195:{const s=this.V();this._s(s);break}case 194:s+=this.Cs(this.V(),!this.hs(128));break;case 202:s+=this.Cs(this.V(),this.hs(128));break;case 210:s+=this.Cs(this.V(),!this.hs(16));break;case 218:s+=this.Cs(this.V(),this.hs(16));break;case 224:this.R.write(65280+this.q(),this.B.p());break;case 226:this.R.write(65280+this.M.v(),this.B.p());break;case 240:this.B.u(this.R.read(65280+this.q()));break;case 242:this.B.u(this.R.read(65280+this.M.v()));break;case 24:{const s=this.q();this.Rs(s);break}case 32:case 32:s+=this.Ss(this.q(),!this.hs(128));break;case 40:case 40:s+=this.Ss(this.q(),this.hs(128));break;case 48:case 48:s+=this.Ss(this.q(),!this.hs(16));break;case 56:case 56:s+=this.Ss(this.q(),this.hs(16));break;case 196:s+=this.js(this.V(),!this.hs(128));break;case 204:s+=this.js(this.V(),this.hs(128));break;case 212:s+=this.js(this.V(),!this.hs(16));break;case 220:s+=this.js(this.V(),this.hs(16));break;case 205:this.xs(this.V());break;case 201:this.As();break;case 192:s+=this.Us(!this.hs(128));break;case 200:s+=this.Us(this.hs(128));break;case 208:s+=this.Us(!this.hs(16));break;case 216:s+=this.Us(this.hs(16));break;case 199:this.xs(0);break;case 207:this.xs(8);break;case 215:this.xs(16);break;case 223:this.xs(24);break;case 231:this.xs(32);break;case 239:this.xs(40);break;case 247:this.xs(48);break;case 255:this.xs(56);break;case 217:this.As(),this.K|=1;break;case 243:this.K=0;break;case 251:this.K|=2;break;case 203:this.Bs(c);break;default:throw"Unhandled opcode "+r}return s+=203==r?e.L[c]:e.O[r],s}}t.default=e},171:function(s,t,i){var h=this&&this.Ps||(Object.create?function(s,t,i,h){void 0===h&&(h=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&!("get"in e?!t.t:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(s,h,e)}:function(s,t,i,h){void 0===h&&(h=i),s[h]=t[i]}),e=this&&this.Es||(Object.create?function(s,t){Object.defineProperty(s,"default",{enumerable:!0,value:t})}:function(s,t){s.default=t}),a=this&&this.Hs||function(s){if(s&&s.t)return s;var t={};if(null!=s)for(var i in s)"default"!==i&&Object.prototype.hasOwnProperty.call(s,i)&&h(t,s,i);return e(t,s),t},r=this&&this.Ks||function(s){return s&&s.t?s:{default:s}};Object.defineProperty(t,"t",{value:!0});const c=a(i(806)),b=r(i(706)),n=r(i(364));function k(s,t,i){const h=s.createShader(i);if(!h)throw"Unable to create shader of type "+i;if(s.shaderSource(h,t),s.compileShader(h),!s.getShaderParameter(h,s.COMPILE_STATUS))throw"Unable to compile shader "+t+" "+s.getShaderInfoLog(h);return h}function o(){const s=document.getElementById("gb-canvas"),t=(document.body.clientWidth-32)/160,i=(document.body.clientHeight-96)/144,h=Math.floor(Math.max(1,Math.min(5,t,i)));s.width=160*h,s.height=144*h}async function u(){const s=[{title:"ROM: Ball game",data:new Uint8Array(await(await fetch("roms/ballgame.gb")).arrayBuffer())}];o(),Array.from(document.getElementsByClassName("loading")).forEach((s=>s.style.display="none")),Array.from(document.getElementsByClassName("loaded")).forEach((s=>s.style.display="inherit"));let t=0;document.getElementById("rom-title").textContent=s[t].title;let i=new b.default(new Uint8Array(s[t].data)),h=new n.default(i),e=new c.default(i),a=new c.i(i);const r=()=>{document.getElementById("rom-title").textContent=s[t].title,i=new b.default(new Uint8Array(s[t].data)),h=new n.default(i),e=new c.default(i),a=new c.i(i)},u=document.getElementById("gb-canvas").getContext("webgl2"),l=u.createTexture();u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,l),u.pixelStorei(u.UNPACK_ALIGNMENT,1),u.texImage2D(u.TEXTURE_2D,0,u.R8,160,144,0,u.RED,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);const f=u.createTexture();u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f),u.texImage2D(u.TEXTURE_2D,0,u.RGB8,4,1,0,u.RGB,u.UNSIGNED_BYTE,new Uint8Array([0,0,0,20,0,0,100,255,100,255,255,255])),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);const d=k(u,"#version 300 es\n\nprecision mediump float;\nin vec2 frag_texcoord;\nout vec4 frag_color;\nuniform sampler2D tex;\nuniform sampler2D tex_palette;\n\nvoid main() {\n    float pal0 = texture(tex, frag_texcoord.xy).r;\n    vec3 r_color = texture(tex_palette, vec2(pal0, 0.0)).rgb;\n    frag_color = vec4(r_color, 1.0);\n}\n",u.FRAGMENT_SHADER),w=k(u,"#version 300 es\n\nprecision mediump float;\nin vec2 pos;\nout vec2 frag_texcoord;\n\nvoid main() {\n    vec2 screenpos = 2.0 * pos - vec2(1.0, 1.0);\n    gl_Position = vec4(screenpos.xy, 0.0, 1.0);\n    frag_texcoord.xy = vec2(pos.x, 1.0 - pos.y);\n}\n",u.VERTEX_SHADER),m=function(s,t,i){const h=s.createProgram();if(!h)throw"Unable to create program";if(s.attachShader(h,t),s.attachShader(h,i),s.linkProgram(h),!s.getProgramParameter(h,s.LINK_STATUS))throw"Unable to link program "+s.getProgramInfoLog(h);return h}(u,w,d);u.useProgram(m);const p=u.createBuffer(),v=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,p),u.bufferData(u.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,v),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),u.STATIC_DRAW);const g=u.getAttribLocation(m,"pos"),y=u.getUniformLocation(m,"tex"),_=u.getUniformLocation(m,"tex_palette");u.enableVertexAttribArray(g),u.vertexAttribPointer(g,2,u.FLOAT,!1,8,0),u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.canvas.width,u.canvas.height),u.clearColor(1,1,1,1),u.clear(u.COLOR_BUFFER_BIT);let R=0;const A=()=>{for(;R<17556;){const s=e.S();h.S(s,!0),a.S(s),R+=s}R-=17556,u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.canvas.width,u.canvas.height),u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f),u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,l),u.texSubImage2D(u.TEXTURE_2D,0,0,0,160,144,u.RED,u.UNSIGNED_BYTE,new Uint8Array(h.Ts())),u.useProgram(m),u.bindBuffer(u.ARRAY_BUFFER,p),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,v),u.enableVertexAttribArray(g),u.uniform1i(y,0),u.uniform1i(_,1),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),window.requestAnimationFrame(A)};document.addEventListener("keydown",(i=>{switch(i.code){case"ArrowUp":e.Ms(64);break;case"ArrowDown":e.Ms(128);break;case"ArrowLeft":e.Ms(32);break;case"ArrowRight":e.Ms(16);break;case"KeyX":e.Ms(1);break;case"KeyZ":e.Ms(2);break;case"Enter":e.Ms(8);break;case"Backspace":e.Ms(4);break;case"KeyN":t=0==t?s.length-1:t-1,r();break;case"KeyM":t=t+1==s.length?0:t+1,r()}})),document.addEventListener("keyup",(s=>{switch(s.code){case"ArrowUp":e.Ds(64);break;case"ArrowDown":e.Ds(128);break;case"ArrowLeft":e.Ds(32);break;case"ArrowRight":e.Ds(16);break;case"KeyX":e.Ds(1);break;case"KeyZ":e.Ds(2);break;case"Enter":e.Ds(8);break;case"Backspace":e.Ds(4)}})),window.requestAnimationFrame(A)}i(184),"complete"===document.readyState?u():window.onload=s=>u(),window.onresize=()=>o()},706:(s,t)=>{Object.defineProperty(t,"t",{value:!0}),t.default=class{Fs;Is;Ns;Ws;Xs;Ys;constructor(s){switch(this.Is=s,this.Fs=new Uint8Array(65536),this.Xs=0,this.Ns=this.Ws=1,this.Ys=0,s[327]){case 0:this.Ys=0;break;case 1:case 2:case 3:this.Ys=1;break;case 15:case 16:case 17:case 18:case 19:this.Ys=3;break;default:console.log("Unhandled rom type",s[327])}for(let t=0;t<32768;t++)this.Fs[t]=s[t]}read(s){if(s>=16384&&s<32768)switch(this.Ys){case 1:case 3:if(this.Ns)return this.Is[(this.Ns<<14)+(16383&s)];break;case 2:if(this.Ws)return this.Is[(this.Ws<<14)+(16383&s)]}return this.Fs[s]}write(s,t){if(t&=255,s>=65280&&65350==s){const s=t<<8;for(let t=0;t<160;t++)this.Fs[65024+t]=this.Fs[s+t]}else switch(this.Ys){case 1:case 3:s<8192||(s<16384?(this.Ns=31&t,0!=t&&32!=t&&64!=t&&96!=t||++this.Ns):s<24576?0==this.Xs?this.Ns|=(3&t)<<5:this.Ns=3&t:s<32768?this.Xs=t>0?1:0:this.Fs[s]=t);break;case 2:s<8192||(s<16384?(this.Ws=31&t,0!=t&&32!=t&&64!=t&&96!=t||++this.Ws):s>=32768&&(this.Fs[s]=t));break;default:s>=32768&&(this.Fs[s]=t)}}U(s){return this.read(65280+s)}j(s,t){this.write(65280|s,t)}}},364:function(s,t,i){var h=this&&this.Ks||function(s){return s&&s.t?s:{default:s}};Object.defineProperty(t,"t",{value:!0});const e=h(i(806));class a{static Zs=160;static Gs=144;R;state;qs;zs;Js;framebuffer;constructor(s){this.R=s,this.state=0,this.qs=0,this.zs=[],this.framebuffer=new Uint8Array(a.Zs*a.Gs),this.Js=new Uint8Array(a.Zs*a.Gs)}Ts(){return this.framebuffer}Qs(s,t){return(s[0]<<t&128)>>7|(s[1]<<t&128)>>6}Vs(s,t,i){return(i?s<<4:4096+(e.default.G(s)<<4))+(t<<1)}$s(s,t,i,h){const e=this.R.read(32768+(s?7168:6144)+(h>>3<<5)+(i>>3)),a=this.Vs(e,7&h,t);return this.Qs([this.R.read(32768+a),this.R.read(32768+a+1)],7&i)}st(s,t){return t>>2*(s&=3)&3}tt(s,t){const i=this.R.U(64),h=!!(8&i),e=!!(64&i);let r=!!(1&i),c=!!(32&i),b=!!(2&i);const n=!!(16&i),k=this.R.U(67),o=this.R.U(66),u=this.R.U(75),l=this.R.U(74),f=[this.R.U(72),this.R.U(73)];if(c=c&&u<167&&l<144&&l<=s,b=b&&this.zs.length>0,!(c||r||b))return;const d=s+o&255,w=32768+(h?7168:6144)+(d>>3<<5),m=[0,0];for(let i=0;i<a.Zs;i++){let h=0;if(c&&i+7>=u)h=this.$s(e,n,i+7-u,s-l);else if(r){const s=i+k&255;if(!(i&&7&s)){const t=s>>3,i=this.R.read(w+t),h=this.Vs(i,7&d,n);m[0]=this.R.read(32768+h),m[1]=this.R.read(32768+h+1)}h=this.Qs(m,i+k&7)}let o=this.st(h,t);if(b){let s=!1;for(let t=0;t<this.zs.length;t++){const e=this.zs[t];if(i+8<e.x||i+8>=e.x+8)continue;const a=i+8-e.x,r=!!(32&e.it),c=this.Qs(e.ht,r?7-a:a);if(0==c)continue;const b=!(128&e.it);if((s||h>0)&&!b)continue;const n=f[16&e.it?1:0];o=this.st(c,n),s=!0}}this.Js[s*a.Zs+i]=o}}et(s){const t=4&this.R.U(64)?16:8;this.zs.length=0;for(let i=0;i<160;i+=4){const h=this.R.read(65024+i),e=this.R.read(65024+i+1);if(e>0&&h<160&&e<168&&s+16>=h&&s+16<h+t){let a=this.zs.length;for(;a>0&&this.zs[a-1].x>e;)a<10&&(this.zs[a]=this.zs[a-1]),--a;if(a<10){let r=this.R.read(65024+i+2);const c=this.R.read(65024+i+3);16==t&&(r&=254);let b=s+16-h;64&c&&(b=t-1-b);const n=this.Vs(r,b,!0),k={x:e,it:c,ht:[this.R.read(32768+n),this.R.read(32768+n+1)]};a==this.zs.length?this.zs.push(k):this.zs[a]=k}}}}S(s,t){const i=[255,170,133,0],h=this.R.U(71),e=this.R.U(64);let r=this.R.U(65);if(!(0+(128&e)))return this.state=0,this.qs=0,r&=-4,this.R.j(65,r),void this.R.j(68,0);for(this.R.U(68)===this.R.U(69)?4&r||(r|=4,this.R.j(65,r),64&r&&this.R.j(15,2|this.R.U(15))):4&r&&(r&=-5,this.R.j(65,r)),this.qs+=s;this.qs>0;)switch(this.state){case 0:if(2!=(3&r)&&(r=-4&r|2,this.R.j(65,r),32&r&&this.R.j(15,2|this.R.U(15))),this.qs>=20){const s=this.R.U(68);this.et(s),this.state=1;break}return;case 1:if(3&~r&&(r=-4&r|3,this.R.j(65,r)),this.qs>=63){if(t){const s=this.R.U(68);this.tt(s,h)}this.state=2;break}return;case 2:if(3&r&&(r&=-4,this.R.j(65,r),128&r&&this.R.j(15,2|this.R.U(15))),this.qs>=114){this.qs-=114;const s=this.R.U(68)+1;this.state=s<a.Gs?0:3,this.R.j(68,s);break}return;case 3:if(1!=(3&r)&&(r=-4&r|1,this.R.j(65,r),this.R.j(15,1|this.R.U(15)),t))for(let s=0;s<a.Gs;s++){let t=s*a.Zs,h=s*a.Zs;for(let s=0;s<a.Zs;s++)this.framebuffer[h++]=i[3&this.Js[t++]]}if(this.qs>=114){this.qs-=114;let s=this.R.U(68)+1;154===s&&(s=0,this.state=0),this.R.j(68,s);break}return}}}t.default=a},184:(s,t,i)=>{i.r(t)}},t={};function i(h){var e=t[h];if(void 0!==e)return e.exports;var a=t[h]={exports:{}};return s[h].call(a.exports,a,a.exports,i),a.exports}i.r=s=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"t",{value:!0})},i(171)})();